<!--Defines the route for the income page-->
@page "/income"


<nav class="navbar navbar-light justify-content-between">
   
    <h1 class="navbar-brand mb-0 h1 fw-bold" style=" background: #7942CE;
        -webkit-text-fill-color: transparent;
        -webkit-background-clip: text;">
        Income
    </h1>
</nav>

<!-- Table to display all income transactions-->
<table class="table">
    
    <thead>
        <tr>
            /
            <th class="align-baseline">
                <div>Tag</div>
            </th> 
            <th class="align-baseline">
                <div>Amount</div>
            </th> 
            <th class="align-baseline">
                <div>Date</div>
            </th> 
            <th class="align-baseline">
                <div>Note</div>
            </th> 
        </tr>
    </thead>

    // Table body containing income records
    <tbody>
        @{
            // Get all transactions and sort them by date (newest first)
            IEnumerable<Transaction> transactionList = _transactions;
            transactionList = transactionList.OrderByDescending(t =>
            t.Date);

            // Loop through each transaction and display its details
            foreach (var transaction in transactionList)
            {
                <tr>
                    <td>@transaction.Tag</td> 
                    <td>@transaction.Amount</td> 
                    <td>@transaction.Date</td> 
                    <td>@transaction.Note</td> 
                </tr>
            }
        }
    </tbody>
</table>


@code {
    // Get the global state (user information) from the cascading parameter
    [CascadingParameter]
    private GlobalState _globalState { get; set; }

    // Properties to store income-related data
    private double _debtAmount { get; set; } 
    private List<Transaction> _transactions { get; set; } // List of all income transactions
    private string _curr { get; set; } 

    // Initialize component and load data when page loads
    protected override void OnInitialized()
    {
        // Get all transactions of type 'Credit' (income) for the current user
        _transactions = TransactionService.GetTransactionType(_globalState.CurrentUser.Id, TransactionType.Credit);
        // Get user's preferred currency
        _curr = UsersService.GetCurrency(_globalState.CurrentUser.Id);
    }
}